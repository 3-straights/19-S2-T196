<!doctype html>
<!--
 *
 * Utilising Mapbox API
 *
 * Copyright (c) 2019  Monash University
 *
 * Written by Arvind Kaur
 *
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
-->
<html>
<head>
  <title>Utilising Mapbox API</title>
  <style type="text/css">
    .map {
      height: calc(90vh - 70px);
    }


  .otherDep
  {
    width: 100%;
    overflow-y: scroll;
    background-color: #f1f1f1;
  }

  .otherDes
  {
    width: 100%;
    overflow-y: scroll;
    background-color: #f1f1f1;
  }
.destination{
  width: 20%;
  margin-left: 200px;
  border-width: 3px;
  border-style: solid;
  border-color: orange;
}

.departure
{
  width: 20%;
  margin-left: 360px;
  border-width: 3px;
  border-style: solid;
  border-color: orange;
}

  div.yoyo div {float:left}
  </style>
  <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v1.1.1/mapbox-gl.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v1.1.1/mapbox-gl.css' rel='stylesheet' />
  </head>
  <body>
    <div class='yoyo'>
      <div class='departure'>
    <b>Departure:</b>
    <input type="text" id="departure" name="departure" style="float: right" placeholder="From.." onchange = 'otherDep();searchDepPort()'>
    <button type = 'button' style="float: right" onclick = 'setDeparture()' oninput = 'setDeparture()'> Set </button><br>
    <div class= 'otherDep' id='otherDep'></div>
  </div>
  <div class= 'destination' >
    <b>Destination:</b>
    <input type="text" id="destination" name="destination" style="float: right" placeholder="To.." onchange = 'otherDes();searchDesPort()'>
    <button type = 'button' style="float: right" onclick = 'setDestination()' oninput = 'setDestination()'> Set </button><br>
    <div class ='otherDes' id = 'otherDes'></div>
  </div>
  <br><br><br><br><br><br><br><br><br><br><br><br><br>
</div>
<div id = 'portSection'></div>
<br><br>
    <div class='map' id="map"></div>

  </body>

  <script>
function otherDep()
{
  let newDep;
  if (document.getElementById('departure').value == 'other'|| document.getElementById('departure').value == 'Other')
  {
    newDep = 'Departure port: <input type="text" name="departurePort" style="float: right"/><br><br><br>';
    newDep += 'Country: <input type="text" name="departureCountry" style="float: right"/><br><br><br>';
    newDep += 'Longtitude: <input type="text" name="departureLng" style="float: right"/><br><br><br>';
    newDep += 'Latitude: <input type="text" name="departureLat" style="float: right"/><br><br>';
  }
  else
   {
    newDep = ''
  }
    document.getElementById('otherDep').innerHTML = newDep;
  }

function otherDes()

{
  let newDes;

  if (document.getElementById('destination').value == 'other'|| document.getElementById('destination').value == 'Other')
  {
    newDes = 'Departure port: <input type="text" name="departurePort" style="float: right"/><br><br><br>';
    newDes += 'Country: <input type="text" name="departureCountry" style="float: right"/><br><br><br>';
    newDes += 'Longtitude: <input type="text" name="departureLng" style="float: right"/><br><br><br>';
    newDes += 'Latitude: <input type="text" name="departureLat" style="float: right"/><br><br>';
  }
  else
  {
    newDes ='';

  }
  document.getElementById('otherDes').innerHTML = newDes;
}
let portoArray =[];

  for (let p=0; p< JSON.parse(localStorage.getItem("portInformation")).name.length;p++)
  {
portoArray.push(JSON.parse(localStorage.getItem("portInformation")).name[p])
  }

function searchDepPort()
{
  document.getElementById("portSection").innerHTML = '';
  let searchQuery = document.getElementById('departure').value;

  let filterDepPort = portoArray.filter(x => x.includes(searchQuery));
  filterDepPort.forEach(x => document.getElementById('portSection').innerText += x + "\n");
}

function searchDesPort()
{
  document.getElementById("portSection").innerHTML = '';
  let searchQuery2 = document.getElementById('destination').value;

  let filterDesPort = portoArray.filter(x => x.includes(searchQuery2));
  filterDesPort.forEach(x => document.getElementById('portSection').innerText += x + "\n");
}
  </script>
    <script src="map.js"></script>


</html>
